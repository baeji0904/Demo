<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Demo_Game</title>
    <!-- Tailwind CSS CDN ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* ê¸°ë³¸ í…Œë§ˆ ì„¤ì • (ì–´ë‘ìš´ ë°°ê²½, Inter í°íŠ¸) */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* GitHub Dark ë°°ê²½ */
            color: #c9d1d9;
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    <div class="max-w-7xl mx-auto">
        
        <!-- í—¤ë” ë° ê²€ìƒ‰ì°½ -->
        <header class="flex justify-between items-center gap-4 flex-wrap mb-8">
            <!-- ì‹œê°ì ìœ¼ë¡œ ê°•ì¡°ëœ íƒ€ì´í‹€ -->
            <h1 class="text-4xl sm:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-blue-500">
                Demo_Game
            </h1>
            <!-- ê²€ìƒ‰ì°½ ìŠ¤íƒ€ì¼ -->
            <input 
                id="q" 
                type="search" 
                placeholder="ê²Œì„ ê²€ìƒ‰ (ì´ë¦„, íƒœê·¸)..."
                class="bg-gray-800 border border-gray-700 rounded-xl text-white p-3 min-w-60 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 shadow-lg"
            >
        </header>

        <!-- ê²Œì„ ëª©ë¡ ê·¸ë¦¬ë“œ ì»¨í…Œì´ë„ˆ -->
        <!-- ë°˜ì‘í˜• ê·¸ë¦¬ë“œ: ì‘ì€ í™”ë©´ 2ì—´, ì¤‘ê°„ í™”ë©´ 3ì—´, í° í™”ë©´ 4ì—´ -->
        <div id="grid" class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 mt-6" aria-live="polite">
            <!-- JavaScriptì— ì˜í•´ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— ì‚½ì…ë©ë‹ˆë‹¤. -->
        </div>
        
        <!-- í‘¸í„° -->
        <footer class="text-gray-500 text-sm mt-12 pt-6 border-t border-gray-700 text-center">
            &copy; 2024 Demo_Game â€” HTML5 ë°ëª¨ ëª¨ìŒ
        </footer>
    </div>

<script>
/**
 * games/games.jsonì—ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ í™”ë©´ì— ë Œë”ë§í•˜ê³  ê²€ìƒ‰ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.
 * Tailwind CSS í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹œê°ì  íš¨ê³¼ì™€ ë°˜ì‘í˜• ë””ìì¸ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.
 */

(async function(){
    const grid = document.getElementById('grid');
    const q = document.getElementById('q');
    let games = [];

    // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ ì¬ì‹œë„ ë¡œì§ì„ í¬í•¨í•œ fetch í•¨ìˆ˜
    const fetchWithRetry = async (url, options = {}, maxRetries = 3) => {
        for (let i = 0; i < maxRetries; i++) {
            try {
                // !!! ìˆ˜ì •ëœ ë¶€ë¶„: URL íŒŒì‹± ì˜¤ë¥˜ í•´ê²°ì„ ìœ„í•´ ë³µì¡í•œ URL ìƒì„± ë¡œì§ì„ ì œê±°í•˜ê³ ,
                // ëŒ€ì‹  ìš”ì²­ ê²½ë¡œë¥¼ ë£¨íŠ¸(Root) ìƒëŒ€ ê²½ë¡œë¡œ ëª…í™•í•˜ê²Œ ë³€í™˜í•˜ì—¬ fetchë¥¼ ì‹œë„í•©ë‹ˆë‹¤.
                const path = url.startsWith('/') ? url : '/' + url;
                const response = await fetch(path, options);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response;
            } catch (error) {
                console.error(`Fetch attempt ${i + 1} failed for ${url}:`, error.message);
                if (i < maxRetries - 1) {
                    // ì§€ìˆ˜ ë°±ì˜¤í”„: 1ì´ˆ, 2ì´ˆ, 4ì´ˆ ëŒ€ê¸° í›„ ì¬ì‹œë„
                    await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000));
                } else {
                    throw error;
                }
            }
        }
    };

    try {
        // games/games.json íŒŒì¼ ë¡œë“œ (ìºì‹œ ë°©ì§€)
        // fetchWithRetry í•¨ìˆ˜ ë‚´ì—ì„œ ê²½ë¡œê°€ ì´ë¯¸ ë£¨íŠ¸ ìƒëŒ€ ê²½ë¡œë¡œ ë³€í™˜ë©ë‹ˆë‹¤.
        const res = await fetchWithRetry('games/games.json', { cache: 'no-store' });
        games = await res.json();
    } catch(e) {
        // ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
        grid.innerHTML = '<div class="col-span-full text-center p-8 bg-red-900/30 border border-red-700 rounded-xl text-red-300">âš ï¸ ê²Œì„ ëª©ë¡ (games/games.json)ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. íŒŒì¼ ê²½ë¡œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.</div>';
        console.error("Failed to load games data finally:", e);
        return;
    }

    // ê²Œì„ ë°ì´í„°ë¥¼ ë°›ì•„ ì‹œê°ì ìœ¼ë¡œ ë§¤ë ¥ì ì¸ HTML ì¹´ë“œ ë¬¸ìì—´ì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
    const card = (g) => {
        const title = g.title || 'ì´ë¦„ ì—†ìŒ';
        const desc = g.desc || 'ê²Œì„ì— ëŒ€í•œ ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤.';
        // ì¸ë„¤ì¼ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ í”Œë ˆì´ìŠ¤í™€ë” ì´ë¯¸ì§€ ì‚¬ìš©
        const thumbUrl = g.thumb || 'https://placehold.co/600x338/1f2937/9ca3af?text=No+Thumbnail'; 
        
        return `
            <!-- ì¹´ë“œ ë³¸ì²´: ì–´ë‘ìš´ ë°°ê²½, ë‘¥ê·¼ ëª¨ì„œë¦¬, ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ ê·¸ë¦¼ì ë° ìƒìŠ¹ íš¨ê³¼ -->
            <article class="bg-gray-800 rounded-xl overflow-hidden shadow-2xl transition duration-300 hover:shadow-teal-500/50 transform hover:-translate-y-1 flex flex-col">
                
                <!-- ì¸ë„¤ì¼ ì˜ì—­: ë°°ê²½ ì´ë¯¸ì§€ë¡œ í‘œì‹œí•˜ì—¬ ì¢…íš¡ë¹„ 16:9 ìœ ì§€ -->
                <div 
                    class="aspect-[16/9] bg-cover bg-center" 
                    style="background-image: url('${thumbUrl}');"
                    aria-label="${title} ê²Œì„ ìŠ¤í¬ë¦°ìƒ·"
                >
                </div>
                
                <!-- ë©”íƒ€ ì •ë³´ ì˜ì—­: flex-growë¥¼ ì‚¬ìš©í•˜ì—¬ ë²„íŠ¼ì´ í•­ìƒ í•˜ë‹¨ì— ìœ„ì¹˜í•˜ë„ë¡ í•¨ -->
                <div class="p-5 flex-grow">
                    <!-- ì œëª© (ë„˜ì¹  ê²½ìš° ì˜ë¦¼) -->
                    <h3 class="text-xl font-bold mb-2 text-white line-clamp-1">${title}</h3>
                    <!-- ì„¤ëª… (ë„˜ì¹  ê²½ìš° ì˜ë¦¼) -->
                    <p class="text-gray-400 text-sm mb-4 line-clamp-2">${desc}</p>
                    
                    <!-- íƒœê·¸ ëª©ë¡ (ìˆëŠ” ê²½ìš°ì—ë§Œ í‘œì‹œ) -->
                    ${g.tags && g.tags.length > 0 ? `
                        <div class="mt-2 flex flex-wrap gap-1">
                            ${g.tags.map(tag => 
                                `<span class="text-xs bg-teal-900/50 text-teal-300 px-2 py-0.5 rounded-full">${tag}</span>`
                            ).join('')}
                        </div>
                    ` : ''}
                </div>
                
                <!-- ì‹¤í–‰ ë²„íŠ¼: ì¹´ë“œ í•˜ë‹¨ì— ì „ì²´ ë„ˆë¹„ë¡œ ë°°ì¹˜ -->
                <a class="w-full text-center bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-b-xl transition duration-200 shadow-md" 
                   href="${g.url}" 
                   target="_blank" 
                   rel="noopener"
                >
                    â–¶ï¸ ì‹¤í–‰í•˜ê¸°
                </a>
            </article>
        `;
    };

    // í•„í„°ë§ëœ ê²Œì„ ëª©ë¡ì„ ë Œë”ë§í•˜ëŠ” í•¨ìˆ˜
    const render = (list) => {
        grid.innerHTML = list.map(card).join('') || 
            '<div class="col-span-full text-center p-8 text-gray-400">ğŸ” ê²€ìƒ‰ ê²°ê³¼ì™€ ì¼ì¹˜í•˜ëŠ” ê²Œì„ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
    };

    // ê²€ìƒ‰ í…ìŠ¤íŠ¸ì— ë”°ë¼ ê²Œì„ ëª©ë¡ì„ í•„í„°ë§í•˜ëŠ” í•¨ìˆ˜
    const filter = (text) => {
        const t = text.trim().toLowerCase();
        if(!t) return games;
        return games.filter(g => {
            // ì œëª©, ì„¤ëª…, íƒœê·¸ë¥¼ ëª¨ë‘ í¬í•¨í•˜ì—¬ ê²€ìƒ‰
            const searchString = (g.title || '') + ' ' + (g.desc || '') + ' ' + (g.tags || []).join(' ');
            return searchString.toLowerCase().includes(t);
        });
    };

    // ê²€ìƒ‰ ì…ë ¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    q.addEventListener('input', e => render(filter(e.target.value)));
    
    // í˜ì´ì§€ ë¡œë“œ í›„ ì´ˆê¸° ë Œë”ë§
    render(games);
})();
</script>
</body>
</html>
